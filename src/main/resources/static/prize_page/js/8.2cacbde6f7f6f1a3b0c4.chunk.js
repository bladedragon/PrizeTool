(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{HEfu:function(e,t,a){"use strict";a.r(t);var n=a("q1tI"),l=a.n(n),r=a("RIqP"),s=a.n(r),c=a("wIs1"),i=a("Nlzp"),u=a("2K1W"),o=a("xXzL"),m=function(e){var t=o.a.getLocal("dataList");u.a.emit("save"),function(e,t){return e.data.acname?t.some(function(t){return t.acname===e.data.acname&&1===t.status})?(alert("\u8be5\u6d3b\u52a8\u5df2\u7ecf\u88ab\u521b\u5efa\uff01"),!1):!(!e.data.typelist.length&&!e.data.untypelist.length)||(alert("\u8bf7\u521b\u5efa\u5956\u54c1\u7c7b\u578b\uff01"),!1):(alert("\u8bf7\u8f93\u5165\u6d3b\u52a8\u540d\u79f0\uff01"),!1)}(u.a,t)?(t=t.filter(function(e){return e.acname!==u.a.data.acname}),u.a.data.status=2,Object(i.h)(u.a.data),o.a.setLocal("dataList",[].concat(s()(t),[u.a.data])),u.a.init(),u.a.clear(),u.a.removeAll("show"),e.push("/display")):u.a.init()},f=Object(c.a)(function(e){return l.a.createElement("div",{className:"header flex-center"},l.a.createElement("div",{className:"middle flex-between"},l.a.createElement("div",{className:"create-name"},"\u9886\u5956\u6d3b\u52a8\u521b\u5efa"),l.a.createElement("div",{className:"save-btn flex-center",onClick:function(){return m(e.history)}},l.a.createElement("span",null,"\u4fdd\u5b58\u7f16\u8f91"))))}),p=a("lwsE"),d=a.n(p),v=a("W8MJ"),h=a.n(v),y=a("a1gu"),E=a.n(y),g=a("Nsbk"),N=a.n(g),k=a("PJYZ"),x=a.n(k),w=a("7W2i"),b=a.n(w),C=a("lSNA"),L=a.n(C),S=function(e){function t(){return d()(this,t),E()(this,N()(t).apply(this,arguments))}return b()(t,e),h()(t,[{key:"componentWillUnmount",value:function(){u.a.clear()}},{key:"render",value:function(){var e;return u.a.on("save",function(){this.data.acname=e.value.trim()}),u.a.on("show",function(t){e.value=t.acname}),l.a.createElement("div",{className:"nav flex-between"},l.a.createElement("div",{className:"nav-left flex-start"},l.a.createElement("div",{className:"ac-name"},"\u6d3b\u52a8\u540d\u79f0"),l.a.createElement("input",{type:"text",className:"ac-ipt",ref:function(t){e=t}})),l.a.createElement("div",{className:"nav-right flex-center",onClick:this.props.handleCreate},l.a.createElement("span",null,"\u521b\u5efa\u65b0\u7c7b\u578b")))}}]),t}(n.PureComponent),_=a("pVnL"),j=a.n(_),z=function(e){var t,a=e.mark,n=e.type;return u.a.on("save",function(){this.emit(a,{type:n,prize_name:t.value})},a),u.a.on("show",function(e){var n=a.split("-")[1];e["".concat(n,"list")].map(function(e){e.mark===a&&(t.value=e.prize_name)})},a),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"award-type flex-start"},l.a.createElement("div",{className:"type"},n)),l.a.createElement("div",{className:"award-name flex-start"},l.a.createElement("div",{className:"name"},"\u5956\u54c1\u540d\u79f0"),l.a.createElement("input",{ref:function(e){t=e},type:"text",className:"name-ipt"})))},O=a("TSYQ"),A=a.n(O),q=a("EUZL"),D=a.n(q),F=function(e){function t(){var e,a;d()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return a=E()(this,(e=N()(t)).call.apply(e,[this].concat(l))),L()(x()(a),"state",{status:"\u70b9\u51fb\u4e0a\u4f20",list:[],flag:!0}),L()(x()(a),"readFile",function(e){var t=e.target.files[0],n=t.name.split(".");if("xlsx"===n[n.length-1]){var l=new FileReader;l.addEventListener("load",function(e){var t=e.target.result,n=D.a.read(t,{type:"binary"});a.setState({status:"\u5df2\u4e0a\u4f20",list:a.formatData(D.a.utils.sheet_to_json(n.Sheets[n.SheetNames[0]])),flag:!1})}),l.readAsBinaryString(t),a.setState({status:"\u4e0a\u4f20\u4e2d...",flag:!1})}else alert("\u8bf7\u4e0a\u4f20 Excel \u6587\u4ef6\uff01")}),a}return b()(t,e),h()(t,[{key:"init",value:function(){var e=this,t=this.props.mark;u.a.on("save",function(){u.a.emit(t,{student_list:e.state.list})},t),u.a.on("show",function(a){var n=t.split("-")[1];a["".concat(n,"list")].map(function(a){a.mark===t&&a.student_list.length&&e.setState({status:"\u5df2\u4e0a\u4f20",list:a.student_list,flag:!1})})},t)}},{key:"formatData",value:function(e){var t=[["\u5b66\u53f7","stuid"],["\u5b66\u9662","college"],["\u59d3\u540d","stuname"],["\u7535\u8bdd","telephone"]];return e.map(function(e){var a={};return t.map(function(t){e[t[0]]&&(a=Object.assign(a,L()({},t[1],e[t[0]])))}),a})}},{key:"render",value:function(){var e,t=this;return this.state.flag&&this.init(),l.a.createElement("div",{className:"upload flex-start"},l.a.createElement("div",{className:"name"},"\u540d\u5355\u4e0a\u4f20"),l.a.createElement("div",{className:A()("upload-btn","flex-center",{disabled:"\u5df2\u4e0a\u4f20"===this.state.status}),onClick:function(){return e.click()}},l.a.createElement("span",null,this.state.status)),l.a.createElement("div",{className:"download-btn flex-center",onClick:function(){return t.example.click()}},l.a.createElement("span",null,"\u4e0b\u8f7d\u8303\u4f8b")),l.a.createElement("a",{ref:function(e){t.example=e},href:"http://zblade.top/accept_prize/file/standard.xlsx",download:"\u4e0a\u4f20\u540d\u5355\u8303\u4f8b",style:{display:"none"}}),l.a.createElement("input",{type:"file",onChange:this.readFile,className:"file-ipt",ref:function(t){e=t}}))}}]),t}(n.Component),P=function(){var e=new Date,t=e.getMonth()+1,a=e.getDate(),n=t<10?"0"+t:t,l=a<10?"0"+a:a;return"".concat(e.getFullYear(),"-").concat(n,"-").concat(l)},J=function(e){var t,a,n=e.mark;function r(e){var t=e.target.value;/[a-z]/i.test(t)&&(e.target.value="")}return u.a.on("save",function(){var e;e=t.value&&a.value?"".concat(t.value," ~ ").concat(a.value):!t.value&&a.value?"".concat(P()," ~ ").concat(a.value):null,this.emit(n,{prize_date:e})},n),u.a.on("show",function(e){var l=n.split("-")[1];e["".concat(l,"list")].map(function(e){if(e.mark===n&&e.prize_date){var l=e.prize_date.split(" ~ ");t.value=l[0],a.value=l[1]}})},n),l.a.createElement("div",{className:"date-picker flex-start"},l.a.createElement("div",{className:"name"},"\u5151\u5956\u65f6\u95f4"),l.a.createElement("div",{className:"date",style:{marginRight:"50px"}},l.a.createElement("input",{type:"text",className:"start-time",placeholder:P(),maxLength:"10",ref:function(e){t=e},onChange:function(e){return r(e)}})),l.a.createElement("div",{className:"date"},l.a.createElement("input",{type:"text",className:"end-time",placeholder:"\u7ed3\u675f\u65f6\u95f4",maxLength:"10",ref:function(e){a=e},onChange:function(e){return r(e)}})))},R=function(e){var t,a=e.mark;return u.a.on("save",function(){this.emit(a,{push_message:t.value})},a),u.a.on("show",function(e){var n=a.split("-")[1];e["".concat(n,"list")].map(function(e){e.mark===a&&(t.value=e.push_message)})},a),l.a.createElement("div",{className:"publish"},l.a.createElement("div",{className:"name"},"\u7f16\u8f91\u63a8\u9001\u4fe1\u606f"),l.a.createElement("textarea",{ref:function(e){t=e},className:"pub-area"}))},W=l.a.createContext(),B=function(e){var t=e.mark;return l.a.createElement("div",{className:"delete flex-end"},l.a.createElement(W.Consumer,null,function(e){return l.a.createElement("div",{className:"del flex-center",onClick:function(){e(t),u.a.remove(t,t),u.a.remove("save",t)}},l.a.createElement("span",null,"\u5220\u9664\u6b64\u7c7b\u578b"))}))},I=l.a.memo(function(e){var t=[],a=e.mark;return u.a.on(a,function(e){if(t.push(e),4===t.length){var n=Object.assign.apply(Object,[{mark:a}].concat(s()(t)));this.data.typelist.push(n),t=[]}}),l.a.createElement("div",{className:"type-box"},l.a.createElement(z,j()({type:"\u6307\u5b9a\u7c7b\u578b"},e)),l.a.createElement(F,e),l.a.createElement(J,e),l.a.createElement(R,e),l.a.createElement(B,e))}),M=l.a.memo(function(e){var t=e.mark;return u.a.on(t,function(e){e.mark=t,this.data.untypelist.push(e)}),l.a.createElement("div",{className:"type-box"},l.a.createElement(z,j()({type:"\u975e\u6307\u5b9a\u7c7b\u578b"},e)),l.a.createElement(B,e))}),T=function(e){return l.a.createElement("div",{className:"type-box-list"},e.typelist.map(function(e){return l.a.createElement(I,{key:e,mark:e})}),e.untypelist.map(function(e){return l.a.createElement(M,{key:e,mark:e})}))},U=function(e){function t(e){var a;return d()(this,t),a=E()(this,N()(t).call(this,e)),L()(x()(a),"state",{status:""}),L()(x()(a),"handleCreate",function(){u.a.emit("save"),a.validate()?(u.a.data.status=1,a.setState({status:"creating"},function(){Object(i.a)(u.a.data).then(function(e){return a.savetoLocal(e)})})):u.a.init()}),a.ts=["type","untype"],a}return b()(t,e),h()(t,[{key:"validate",value:function(){var e,t=this;return o.a.getLocal("dataList").some(function(e){return e.acname===u.a.data.acname&&1===e.status})?(alert("\u8be5\u6d3b\u52a8\u5df2\u88ab\u521b\u5efa\uff01"),!1):(e=t.ts.every(function(e){return u.a.data["".concat(e,"list")].every(function(e){return Object.values(e).every(function(e){return Array.isArray(e)?e.length:e})})}),t.ts.every(function(e){return!u.a.data["".concat(e,"list")].length})&&(e=!1),!(!u.a.data.acname||!e)||(alert("\u8bf7\u5c06\u4fe1\u606f\u586b\u5199\u5b8c\u6574\uff01"),!1))}},{key:"savetoLocal",value:function(e){var t=u.a.data.acname,a=o.a.getLocal("dataList"),n=o.a.getLocal("qrcodeList");a=a.filter(function(e){return e.acname!==t}),o.a.setLocal("dataList",[].concat(s()(a),[u.a.data])),o.a.setLocal("qrcodeList",[].concat(s()(n),[{acname:t,qrlist:e}])),u.a.init(),u.a.clear(),u.a.removeAll("show"),this.props.history.push("/success?acname=".concat(t))}},{key:"render",value:function(){return l.a.createElement("div",{className:"qr-create flex-center"},l.a.createElement("div",{className:A()("qr-btn","flex-center",{disabled:"creating"===this.state.status}),onClick:this.handleCreate},l.a.createElement("span",null,"creating"===this.state.status?"\u751f\u6210\u4e2d...":"\u751f\u6210\u4e8c\u7ef4\u7801")))}}]),t}(n.Component),Y=Object(c.a)(U),Z=["type","untype"],H=function(e){return l.a.createElement("div",{className:A()("shadow-box","choose",{active:e.active})},l.a.createElement("div",{className:"choose-box flex-col-between"},l.a.createElement("div",{className:"title"},"\u8bf7\u9009\u62e9\u9886\u5956\u7c7b\u578b"),l.a.createElement("div",{className:"type-wrap flex-between"},Z.map(function(t,a){return l.a.createElement("div",{key:a,className:"flex-center",onClick:function(){return e.handleChoose(t)}},l.a.createElement("span",null,"type"===t?"\u6307\u5b9a\u7c7b\u578b":"\u975e\u6307\u5b9a\u7c7b\u578b"))}))))},K=function(e){function t(){var e,a;d()(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return a=E()(this,(e=N()(t)).call.apply(e,[this].concat(l))),L()(x()(a),"state",{show:!1,typelist:[],untypelist:[]}),L()(x()(a),"handleCreate",function(){a.setState({show:!0})}),L()(x()(a),"handleChoose",function(e){"type"===e?a.setState({show:!1,typelist:[].concat(s()(a.state.typelist),[(new Date).getTime()+"-"+e])}):"untype"===e&&a.setState({show:!1,untypelist:[].concat(s()(a.state.untypelist),[(new Date).getTime()+"-"+e])})}),L()(x()(a),"deleteBox",function(e){var t=e.split("-")[1];"type"===t?a.setState({typelist:s()(a.state.typelist.filter(function(t){return t!==e}))}):"untype"===t&&a.setState({untypelist:s()(a.state.untypelist.filter(function(t){return t!==e}))})}),a}return b()(t,e),h()(t,[{key:"componentDidMount",value:function(){var e=this,t=new URLSearchParams(this.props.location.search).get("acname"),a=o.a.getLocal("dataList");a.length&&a.map(function(a){a.acname===t&&2===a.status&&e.setState({typelist:a.typelist.map(function(e){return e.mark}),untypelist:a.untypelist.map(function(e){return e.mark})},function(){u.a.emit("show",a)})})}},{key:"render",value:function(){return l.a.createElement("div",{className:"main"},l.a.createElement(S,{handleCreate:this.handleCreate}),l.a.createElement(W.Provider,{value:this.deleteBox},l.a.createElement(T,{typelist:this.state.typelist,untypelist:this.state.untypelist})),l.a.createElement(Y,null),l.a.createElement(H,{active:this.state.show,handleChoose:this.handleChoose}))}}]),t}(n.Component),Q=Object(c.a)(K);a("y4df"),t.default=function(){return l.a.createElement("div",{className:"create"},l.a.createElement(f,null),l.a.createElement(Q,null))}},y4df:function(e,t,a){}}]);